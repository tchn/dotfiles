truecrypt_mount() {
    set_default
    truecrypt --mount --filesystem=hfsplus
}

truecrypt_umount() {
    set_default
    local i
    sudo umount /media/truecrypt*
    sudo umount /tmp/.truecrypt_aux_mnt*
    for i in /dev/mapper/truecrypt[0-9]#; do
        sudo cryptsetup -v remove "$i"
    done
}

drop_caches() {
    set_default;
    sync;
    if asroot; then
        echo -n "Dropping cache... ";
        echo 3 >/dev/null | sudo tee /proc/sys/vm/drop_caches >/dev/null;
        echo "Done";
    fi;
}

cp2clip() {
    set_default
    if_exists $(which xclip) && xclip -i -selection clipboard
}

mcd() {
    set_default
    mkdir -p "$1" && cd "$1"
}

wifiscan() {
    set_default;
    local wlan="$1"
    if_exists $(whereis iwlist | awk -F ' ' '{print $2}') && sudo iwlist "$wlan" scan | egrep -i 'cell|essid|encryption|quality';
}

ccscope() {
    set_default;
    local project_dir="$1";
    if [ ! -d "$project_dir" ]; then echo "project dir needs to be given"; fi;
    local cscope_file="${project_dir}/cscope.files";
    find "$project_dir" -name "*.c" -o -name "*.h" -o -name "*.cpp" | tee "${cscope_file}";
    pushd "$project_dir";
    cscope -b -q -k cscope.files;
    popd;
}

randstr() {
    set_default;
    strings /dev/urandom | grep -o '[[:print:]]' | head -n 32 | tr -d '\n';
}

keycode() {
    set_default;
    xev | grep -A2 --line-buffered '^KeyRelease' | sed -n '/keycode /s/^.*keycode \([0-9]*\).* (.*, \(.*\)).*$/\1 \2/p'
}

capdump() {
    set_default;
    local interface;
    local my_ether_addr;
    local out_filename;
    interface="$1";
    out_filename=$(echo $(date +%Y%m%d-%s)).pcap;
    my_ether_addr=$(cat /sys/class/net/${interface}/address)
    dumpcap -i "${interface}" -w "${out_filename}" -f "ether host not ${my_ether_addr}" -P;
}

run_ap() {
    set_default;
    local ssid psk in_inf;
    if [ ! -f ~/.hostapd.conf ]; then
        ssid="$1";
        in_inf="$2";
        echo -n "Input PSK: ";
        while read -s psk; do break; done
    cat > ~/.hostapd.conf <<EOF
interface=$in_inf
driver=nl80211
ssid=$ssid
channel=6
hw_mode=g
auth_algs=1
wpa=3
wpa_passphrase=$psk
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
rsn_pairwise=CCMP
EOF
    fi;
    chmod 0600 ~/.hostapd.conf;
    sudo hostapd ~/.hostapd.conf;
}
